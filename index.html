<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RockBlock Message Sender</title>
    <script type="module" src="https://pyscript.net/latest/pyscript.js"></script>
</head>
<body>
    <h1>RockBlock Message Sender</h1>
    <button id="sendButton" py-click="send_message">Send Test Message</button>
    <p id="status">Message status: Not sent</p>

    <py-script>
        import js
        import asyncio
        import urllib.parse
        from pyodide.http import pyfetch

        async def send_message():
            base_url = "https://simulation-hello-world-2025.onrender.com/rockblock"
            imei = "300434065264590"
            data = "01020304"  # Example hex data

            params = urllib.parse.urlencode({"imei": imei, "data": data})
            url = f"{base_url}?{params}"

            try:
                response = await pyfetch(url, method="POST", headers={"Content-Type": "application/x-www-form-urlencoded"})
                result = await response.text()

                if response.status == 200:
                    js.document.getElementById("status").textContent = "Message sent successfully!"
                else:
                    js.document.getElementById("status").textContent = f"Error: {result}"
            except Exception as e:
                js.document.getElementById("status").textContent = f"Request failed: {str(e)}"

    </py-script>
</body>
</html>





